🎹 PyPiano - Engine v6.0
"命运的齿轮还在转动，但这一次，咬合的齿牙间，多了一份坚定。"

1. 项目来源与说明 (Introduction)
本项目基于 A4foolU 的原始 Python 钢琴项目进行深度开发与重构。
我们引入了 PyPiano Engine v6.0 核心，将原本的 MIDI 播放器升级为一台具有“声学物理特性”的虚拟钢琴：

绝对时间切片 (Absolute Timing)：抛弃传统的逐行扫描，采用纳秒级时间戳调度，完美支持 3对4 (Polyrhythm) 等复杂复节奏。

非线性力度与动量 (Momentum & Dynamics)：模拟手臂重量与惯性，力度不再是冰冷的数字，而是具有物理连贯性的曲线。

物理模型 (Physical Modeling)：

琴弦共振 (Sympathetic Resonance)：模拟未止音琴弦间的泛音共振。

半踏板 (Half-Pedal)：支持连续的踏板深度（0.0 - 1.0），而非简单的开关。

机械噪声：模拟释键时的制音器物理噪声。

高级演奏技巧：原生支持 三连音 (Tuplet)、琶音 (Arpeggio)、刮奏 (Glissando)、倚音 (Grace Note)。

2. 快速开始 (Quick Start)
🛠️ 环境准备
请确保您的电脑已安装 Python 3.12 或 3.13。

安装依赖库：

Bash
pip install pygame numpy
目录结构：

Plaintext
PyPiano-Root/
├── main.py                # 主程序入口 (参数配置中心)
├── playPiano.py           # v6.0 音频物理引擎核心
└── resources/             # [核心资源文件夹]
    ├── notes/             # 存放乐谱文件 (.notes)
    └── sounds/            # 存放 .wav 钢琴采样
运行：

Bash
python main.py
3. 乐谱编写指南 (Scoring Guide) ✨ v6.0 新增
本项目采用 “双轨文本谱” 系统，支持 数字简谱 与 国际音名 混写。

📂 文件配对规则
每首乐曲需包含两个行数严格对齐的文件：

主旋律：歌名_速度.notes (Right Hand / Melody)

伴奏：歌名_速度.accompaniments (Left Hand / Harmony)

注：文件名中的“速度”代表每行代码的时值 (ms/step)。推荐 263ms (约 57 BPM 的十六分音符)。

🎵 核心语法 (Basic Syntax)
1. 音符表示 (Notes)
支持两种写法，可在一行内混用：

简谱写法 (推荐)：

1 ~ 7：对应 C 大调音阶。

+ / -：表示升/降八度。例：1+ (高音Do), 5-- (倍低音So)。

# / b：升降号。例：#1 (升Do), b3 (降Mi)。

力度：@1-16。例：1+@14 (强音), 3@6 (弱音)。

音名写法：

C4, F#3, Bb2。例：C#5@12。

2. 时值控制 (Timing & Sustain)
0 (延音/保持)：手指按住不放，声音延续。

0! (强制阻断/休止)：v6.0 新特性。手指离开琴键，强制切断声音（Staccato/跳音必备）。

_ (休止符)：空白，无动作。

3. 和弦 (Chords)
使用方括号 [] 包裹多个音符。

[1, 3, 5]：C大调和弦，三音齐响。

[1+@12, 3+@10, 5+@8]：支持单独定义每个音的力度（突出旋律音）。

🚀 高级技巧 (Advanced Techniques)
1. 三连音与复杂节奏 (Tuplets)
使用花括号 {} 包裹音符，实现“把 N 个音塞进 M 行时间”的效果。

基本连音：

Plaintext
{1; 2; 3}    // 将 1,2,3 三个音压缩在 1 行的时间内弹完 (极快)
自定义时长 (使用 . 点号)：
点号 . 用于撑开连音的“时间容器”。

Plaintext
// 标准八分三连音 (3个音占 2行/半拍)
{1; 2; 3} . 

// 慢速三连音 (3个音占 4行/一拍)
{1; 2; 3} . . .
口诀：花括号 {} 决定弹什么，后面的点号 . 决定弹多慢。

2. 琶音 (Arpeggio)
在和弦方括号前加波浪号 ~，模拟手指顺次拂过琴键的效果。

写法：~[1, 3, 5]

效果：Do -> (35ms) -> Mi -> (35ms) -> So。

应用：用于抒情段落的和弦铺底，或装饰音。

3. 倚音 (Grace Note)
利用琶音引擎的微延迟特性实现。

写法：~[b3, 3] (先弹降Mi，极快滑向Mi，模拟蓝调风格)。

4. 刮奏 (Glissando)
利用长连音实现。

写法：{[1;2;3;4;5;6;7;1+;2+;3+]} . . . (在指定时间内均匀扫过所有音)。

🦶 物理踏板系统 (Pedals)
支持复合指令，用 | 分隔。

延音踏板：P+ (踩下/共振开启), P- (抬起/止音)。

柔音踏板：U+ (踩下/音色变暗), U- (抬起)。

半踏板 (Half-Pedal)：PH0.5 (踩一半), PH0.8 (踩深一点)。

经典换踏技巧 (Syncopated Pedal)：

Plaintext
// 在弹奏新和弦的瞬间，先切断上一小节的混响(P-)，再立刻踩下(P+)
P-|P+|1--@12
4. 谱例展示 (Example)
文件名: redbean_263.notes (《红豆》片段)

Plaintext
// --- 3对4 复节奏演示 ---
// 右手 (Melody): 三连音 "相聚离"
{[7+@11, 3+@8]; [6+@11, 3+@8]; [5+@11, 3+@8]} . . . 

// 左手 (Accompaniment): 普通十六分音符 (需写在 .accompaniments 文件中)
// 5--@10
// 3-@7
// 5-@7
// 7-@7
文件名: gliss_test.notes (高级技巧演示)

Plaintext
// 琶音进入
P-|P+|~[1,3,5]@10
0
0

// 快速半音阶刮奏
{[1; #1; 2; #2; 3; 4; #4; 5]} . 

// 强制顿奏 (Staccato)
1+@14
0!
0
